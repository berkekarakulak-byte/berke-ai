<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Berke AI â€” Admin Panel</title>

<style>
:root{
  --bg:#0f172a;
  --panel:#020617;
  --border:#1e293b;
  --text:#e5e7eb;
  --muted:#94a3b8;
  --accent:#2563eb;
}
*{box-sizing:border-box}
body{
  margin:0;
  background:var(--bg);
  color:var(--text);
  font-family:Inter,system-ui,Arial;
}
.container{
  max-width:1100px;
  margin:40px auto;
  padding:24px;
}
.header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:24px;
}
.header h1{
  margin:0;
  font-size:22px;
}
.badges{
  display:flex;
  gap:12px;
}
.badge{
  background:var(--panel);
  border:1px solid var(--border);
  padding:10px 16px;
  border-radius:14px;
  font-size:14px;
}
.table-wrap{
  background:var(--panel);
  border:1px solid var(--border);
  border-radius:18px;
  overflow:hidden;
}
table{
  width:100%;
  border-collapse:collapse;
}
thead{
  background:#020617;
}
th,td{
  padding:14px 16px;
  text-align:left;
  font-size:14px;
}
th{
  color:var(--muted);
  font-weight:500;
  border-bottom:1px solid var(--border);
}
td{
  border-bottom:1px solid var(--border);
}
tr:hover{
  background:#020617;
}
.count{
  color:var(--accent);
  font-weight:600;
}
.footer{
  margin-top:16px;
  font-size:12px;
  color:var(--muted);
}
.center{
  text-align:center;
  margin-top:80px;
  font-size:18px;
}
</style>
</head>

<body>

<div class="container">
  <div class="header">
    <h1>ðŸ“Š Berke AI â€” Admin Panel</h1>
    <div class="badges">
      <div class="badge" id="guestBadge">ðŸ‘» Misafir: 0</div>
      <div class="badge" id="userBadge">ðŸ‘¤ Google KullanÄ±cÄ±: 0</div>
    </div>
  </div>

  <div class="table-wrap">
    <table>
      <thead>
        <tr>
          <th>Mail</th>
          <th>GiriÅŸ SayÄ±sÄ±</th>
          <th>Ä°lk GiriÅŸ</th>
          <th>Son GiriÅŸ</th>
        </tr>
      </thead>
      <tbody id="rows"></tbody>
    </table>
  </div>

  <div class="footer">
    ðŸ”’ Bu panel sadece yetkili admin iÃ§in gÃ¶rÃ¼nÃ¼r.
  </div>
</div>

<script>
const params = new URLSearchParams(window.location.search)
const email = params.get("email")

fetch(`/admin/data?email=${email}`)
.then(r=>{
  if(!r.ok) throw "yetkisiz"
  return r.json()
})
.then(data=>{
  guestBadge.innerText = "ðŸ‘» Misafir: " + data.guest_count
  userBadge.innerText = "ðŸ‘¤ Google KullanÄ±cÄ±: " + Object.keys(data.google_users).length

  Object.entries(data.google_users).forEach(([mail,info])=>{
    rows.innerHTML += `
      <tr>
        <td>${mail}</td>
        <td class="count">${info.count}</td>
        <td>${info.first || info.first_login}</td>
        <td>${info.last || info.last_login}</td>
      </tr>
    `
  })
})
.catch(()=>{
  document.body.innerHTML =
    "<div class='center'>â›” Yetkisiz EriÅŸim</div>"
})
</script>

</body>
</html>
